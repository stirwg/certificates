<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Secure Telephone Identity Credentials: Certificates</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
/*]]>*/</style>


  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Authority for Telephone Numbers in Certificates"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Certificate Usage with STIR"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Enrollment and Authorization using the TN Authorization List"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Constraints on Signing PASSporTs"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Certificate Extension Scope and Structure"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Provisioning Private Keying Material"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Acquiring Credentials to Verify Signatures"/>
<link href="#rfc.section.8" rel="Chapter" title="8 JWT Claim Constraints Syntax"/>
<link href="#rfc.section.9" rel="Chapter" title="9 TN Authorization List Syntax"/>
<link href="#rfc.section.10" rel="Chapter" title="10 Certificate Freshness and Revocation"/>
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Acquiring TN Lists By Reference"/>
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations"/>
<link href="#rfc.section.12" rel="Chapter" title="12 Security Considerations"/>
<link href="#rfc.section.13" rel="Chapter" title="13 Acknowledgments"/>
<link href="#rfc.references" rel="Chapter" title="14 References"/>
<link href="#rfc.references.1" rel="Chapter" title="14.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="14.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A ASN.1 Module"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.2 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Peterson, J. and S. Turner" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-stir-certificates-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-4-11" />
  <meta name="dct.abstract" content="In order to prevent the impersonation of telephone numbers on the Internet, some kind of credential system needs to exist that cryptographically asserts authority over telephone numbers.  This document describes the use of certificates in establishing authority over telephone numbers, as a component of a broader architecture for managing telephone numbers as identities in protocols like SIP." />
  <meta name="description" content="In order to prevent the impersonation of telephone numbers on the Internet, some kind of credential system needs to exist that cryptographically asserts authority over telephone numbers.  This document describes the use of certificates in establishing authority over telephone numbers, as a component of a broader architecture for managing telephone numbers as identities in protocols like SIP." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">STIR</td>
  <td class="right">J. Peterson</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Neustar</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">S. Turner</td>
</tr>
<tr>
  <td class="left">Expires: October 13, 2017</td>
  <td class="right">sn3rd</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">April 11, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Secure Telephone Identity Credentials: Certificates<br />
  <span class="filename">draft-ietf-stir-certificates-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>In order to prevent the impersonation of telephone numbers on the Internet, some kind of credential system needs to exist that cryptographically asserts authority over telephone numbers.  This document describes the use of certificates in establishing authority over telephone numbers, as a component of a broader architecture for managing telephone numbers as identities in protocols like SIP.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 13, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Authority for Telephone Numbers in Certificates</a></li>
<li>4.   <a href="#rfc.section.4">Certificate Usage with STIR</a></li>
<li>5.   <a href="#rfc.section.5">Enrollment and Authorization using the TN Authorization List</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Constraints on Signing PASSporTs</a></li>
<li>5.2.   <a href="#rfc.section.5.2">Certificate Extension Scope and Structure</a></li>
</ul><li>6.   <a href="#rfc.section.6">Provisioning Private Keying Material</a></li>
<li>7.   <a href="#rfc.section.7">Acquiring Credentials to Verify Signatures</a></li>
<li>8.   <a href="#rfc.section.8">JWT Claim Constraints Syntax</a></li>
<li>9.   <a href="#rfc.section.9">TN Authorization List Syntax</a></li>
<li>10.   <a href="#rfc.section.10">Certificate Freshness and Revocation</a></li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Acquiring TN Lists By Reference</a></li>
</ul><li>11.   <a href="#rfc.section.11">IANA Considerations</a></li>
<li>12.   <a href="#rfc.section.12">Security Considerations</a></li>
<li>13.   <a href="#rfc.section.13">Acknowledgments</a></li>
<li>14.   <a href="#rfc.references">References</a></li>
<ul><li>14.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>14.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">ASN.1 Module</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">The STIR problem statement <a href="#RFC7340">[RFC7340]</a> identifies the primary enabler of robocalling, vishing, swatting and related attacks as the capability to impersonate a calling party number.  The starkest examples of these attacks are cases where automated callees on the PSTN rely on the calling number as a security measure, for example to access a voicemail system.  Robocallers use impersonation as a means of obscuring identity; while robocallers can, in the ordinary PSTN, block (that is, withhold) their caller identity, callees are less likely to pick up calls from blocked identities, and therefore appearing to call from some number, any number, is preferable.  Robocallers however prefer not to call from a number that can trace back to the robocaller, and therefore they impersonate numbers that are not assigned to them.</p>
<p id="rfc.section.1.p.2">One of the most important components of a system to prevent impersonation is the implementation of credentials which identify the parties who control telephone numbers.  With these credentials, parties can assert that they are in fact authorized to use telephony numbers, and thus distinguish themselves from impersonators unable to present such credentials.  For that reason the STIR threat model <a href="#RFC7375">[RFC7375]</a> stipulates, &#8220;The design of the credential system envisioned as a solution to these threats must, for example, limit the scope of the credentials issued to carriers or national authorities to those numbers that fall under their purview.&#8221;  This document describes credential systems for telephone numbers based on <a href="#X.509">[X.509]</a> version 3 certificates in accordance with <a href="#RFC5280">[RFC5280]</a>.  While telephone numbers have long been part of the X.509 standard (X.509 supports arbitrary naming attributes to be included in a certificate; the telephoneNumber attribute was defined in the 1988 <a href="#X.520">[X.520]</a> specification) this document provides ways to determine authority more aligned with telephone network requirements, including extending X.509 with a Telephone Number Authorization List certificate extension which binds certificates to asserted authority for particular telephone numbers, or potentially telephone number blocks or ranges.</p>
<p id="rfc.section.1.p.3">In the STIR in-band architecture specified in <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a>, two basic types of entities need access to these credentials: authentication services, and verification services (or verifiers).  An authentication service must be operated by an entity enrolled with the certification authority (CA, see <a href="#enrollment">Section 5</a>), whereas a verifier need only trust the trust anchor of the authority, and have a means to access and validate the public keys associated with these certificates.  Although the guidance in this document is written with the STIR in-band architecture in mind, the credential system described in this document could be useful for other protocols that want to make use of certificates to assert authority over telephone numbers on the Internet.</p>
<p id="rfc.section.1.p.4">This document specifies only the credential syntax and semantics necessary to support this architecture.  It does not assume any particular CA or deployment environment.  We anticipate that some deployment experience will be necessary to determine optimal operational models.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#authority-for-telephone-numbers-in-certificates" id="authority-for-telephone-numbers-in-certificates">Authority for Telephone Numbers in Certificates</a></h1>
<p id="rfc.section.3.p.1">At a high level, this specification details two non-exclusive approaches that can be employed to determine authority over telephone numbers with certificates.</p>
<p id="rfc.section.3.p.2">The first approach is to leverage the existing subject of the certificate to ascertain that the holder of the certificate is authorized to claim authority over a telephone number.  The subject might be represented as a domain name in the subjectAltName, such as an &#8220;example.net&#8221; where that domain is known to relying parties as a carrier, or represented with other identifiers related to the operation of the telephone network including Service Provider codes (SPCs) such as OCNs or SPIDs via the TN Authorization List specified in this document.  A relying party could then employ an external data set or service that determines whether or not a specific telephone number is under the authority of the carrier identified as the subject of the certificate, and use that to ascertain whether or not the carrier should have authority over a telephone number.  Potentially, a certificate extension to convey the URI of such an information service trusted by the issuer of the certificate could be developed (though this specification does not propose one).  Alternatively, some relying parties could form bilateral or multilateral trust relationships with peer carriers, trusting one another&#8217;s assertions just as telephone carriers in the SS7 network today rely on transitive trust when displaying the calling party telephone number received through SS7 signaling.</p>
<p id="rfc.section.3.p.3">The second approach is to extend the syntax of certificates to include a new attribute, defined here as TN Authorization List, which contains a list of telephone numbers defining the scope of authority of the certificate.  Relying parties, if they trust the issuer of the certificate as a source of authoritative information on telephone numbers, could therefore use the TN Authorization List instead of the subject of the certificate to make a decision about whether or not the signer has authority over a particular telephone number.  The TN Authorization List could be provided in one of two ways: as a literal value in the certificate, or as a network service that allows relying parties to query in real time to determine that a telephone number is in the scope of a certificate.  Using the TN Authorization list rather than the certificate subject makes sense when, for example, for privacy reasons, the certificate owner would prefer not to be identified, or in cases where the holder of the certificate does not participate in the sort of traditional carrier infrastructure that the first approach assumes.</p>
<p id="rfc.section.3.p.4">The first approach requires little change to existing Public Key Infrastructure (PKI) certificates; for the second approach, we must define an appropriate enrollment and authorization process.  For the purposes of STIR, the over-the-wire format specified in <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> accommodates either of these approaches: the methods for canonicalizing, signing, for identifying and accessing the certificate and so on remain the same; it is only the verifier behavior and authorization decision that will change depending on the approach to telephone number authority taken by the certificate.  For that reason, the two approaches are not mutually exclusive, and in fact a certificate issued to a traditional telephone network service provider could contain a TN Authorization List or not, were it supported by the CA issuing the credential.  Regardless of which approach is used, certificates that assert authority over telephone numbers are subject to the ordinary operational procedures that govern certificate use per <a href="#RFC5280">[RFC5280]</a>.  This means that verification services must be mindful of the need to ensure that they trust the trust anchor that issued the certificate, and that they have some means to determine the freshness of the certificate (see <a href="#cert-fresh">Section 10</a>).</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#certificate-usage-with-stir" id="certificate-usage-with-stir">Certificate Usage with STIR</a></h1>
<p><a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> Section 7.4 requires that all credential systems used by STIR explain how they address the requirements enumerated below.  Certificates as described in this document address the STIR requirements as follows:</p>
<p/>

<ol>
  <li>The URI <a href="#RFC3986">[RFC3986]</a> schemes permitted in the SIP Identity header &#8220;info&#8221; parameter, as well as any special procedures required to dereference the URIs: while normative text is given below in Section 7, this mechanism permits the HTTP <a href="#RFC7230">[RFC7230]</a>, CID and SIP URI schemes to appear in the &#8220;info&#8221; parameter.</li>
  <li>Procedures required to extract keying material from the resources designated by the URI: implementations perform no special procedures beyond dereferencing the &#8220;info&#8221; URI.  See Section 7.</li>
  <li>Procedures used by the verification service to determine the scope of the credential: this specification effectively proposes two methods, as outlined in Section 3: one where the subject (or more properly subjectAltName) of the certificate indicates the scope of authority through a domain name, and relying parties either trust the subject entirely or have some direct means of determining whether or not a number falls under a subject&#8217;s authority; and another where an extension to the certificate as described in Section 9 identifies the scope of authority of the certificate.</li>
  <li>The cryptographic algorithms required to validate the credentials: for this specification, that means the signature algorithms used to sign certificates.  This specification REQUIRES that implementations support both ECDSA with the P-256 curve (see <a href="#DSS">[DSS]</a>) and RSA PKCS#1 v1.5 (see <a href="#RFC3447">[RFC3447]</a> Section 8.2) for certificate signatures.  Implementers are advised that RS256 is mandated only as a transitional mechanism, due to its widespread use in existing PKI, but we anticipate that this mechanism will eventually be deprecated.</li>
  <li>Finally, note that all certificates compliant with this specification:  <ul><li>MUST provide cryptographic keying material sufficient to generate the ECDSA using P-256 and SHA-256 signatures necessary to support the ES256 hashed signatures required by PASSporT <a href="#I-D.ietf-stir-passport">[I-D.ietf-stir-passport]</a>, which in turn follows JSON Web Token (JWT) <a href="#RFC7519">[RFC7519]</a>.</li><li>MUST support both ECDSA with P-256 and RSA PKCS#1 v1.5 for certificate signature verification.</li></ul></li>
</ol>
<p id="rfc.section.4.p.3">This document also includes additional certificate-related requirements:</p>
<p/>

<ul>
  <li>See Section 5.1 for requirements related to the certificate policies extension.</li>
  <li>See Section 7 for requirements related to relying parties acquiring credentials.</li>
  <li>See Section 10 and Section 10.1 for requirements related to certificate freshness and the Authority Information Access (AIA) certificate extension.</li>
</ul>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#enrollment" id="enrollment">Enrollment and Authorization using the TN Authorization List</a></h1>
<p id="rfc.section.5.p.1">This document covers three models for enrollment when using the TN Authorization List extension.</p>
<p id="rfc.section.5.p.2">The first enrollment model is one where the CA acts in concert with national numbering authorities to issue credentials to those parties to whom numbers are assigned.  In the United States, for example, telephone number blocks are assigned to Local Exchange Carriers (LECs) by the North American Numbering Plan Administrator (NANPA), who is in turn directed by the national regulator.  LECs may also receive numbers in smaller allocations, through number pooling, or via an individual assignment through number portability.  LECs assign numbers to customers, who may be private individuals or organizations - and organizations take responsibility for assigning numbers within their own enterprise.  This model requires top-down adoption of the model from regulators through to carriers.  Assignees of E.164 numbering resources participating in this enrollment model should take appropriate steps to establish trust anchors.</p>
<p id="rfc.section.5.p.3">The second enrollment model is a bottom-up approach where a CA requires that an entity prove control by means of some sort of test, which, as with certification authorities for web PKI, might either be automated or a manual administrative process.  As an example of an automated process, an authority might send a text message to a telephone number containing a URL (which might be dereferenced by the recipient) as a means of verifying that a user has control of terminal corresponding to that number.  Checks of this form are frequently used in commercial systems today to validate telephone numbers provided by users.  This is comparable to existing enrollment systems used by some certificate authorities for issuing S/MIME credentials for email by verifying that the party applying for a credential receives mail at the email address in question.</p>
<p id="rfc.section.5.p.4">The third enrollment model is delegation: that is, the holder of a certificate (assigned by either of the two methods above) might delegate some or all of their authority to another party.  In some cases, multiple levels of delegation could occur: a LEC, for example, might delegate authority to a customer organization for a block of 100 numbers used by an IP PBX, and the organization might in turn delegate authority for a particular number to an individual employee.  This is analogous to delegation of organizational identities in traditional hierarchical PKIs who use the name constraints extension <a href="#RFC5280">[RFC5280]</a>; the root CA delegates names in sales to the sales department CA, names in development to the development CA, etc.  As lengthy certificate delegation chains are brittle, however, and can cause delays in the verification process, this document considers optimizations to reduce the complexity of verification.</p>
<p id="rfc.section.5.p.5">Future work might explore methods of partial delegation, where certificate holders delegate only part of their authority.  For example, individual assignees may want to delegate to a service authority for text messages associated with their telephone number, but not for other functions.</p>
<h2 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#constraints-on-signing-passports" id="constraints-on-signing-passports">Constraints on Signing PASSporTs</a></h2>
<p id="rfc.section.5.1.p.1">The public key in the certificate is used to validate the signature on a JSON Web Token (JWT) <a href="#RFC7519">[RFC7519]</a> that conforms to the conventions specified in PASSporT <a href="#I-D.ietf-stir-passport">[I-D.ietf-stir-passport]</a>.  This specification supports constraints on the JWT claims, which allows the CA to grant different permissions to certificate holders, for example those enrolled from proof-of-possession versus delegation.  A Certification Policy and a Certification Practice Statement <a href="#RFC3647">[RFC3647]</a> are produced as part of the normal PKI bootstrapping process, (i.e., the CP is written first and then the CA says how it conforms to the CP in the CPS).  A CA that wishes to place constraints on the JWT claims MUST include the JWT Claim Constraints certificate extension in issued certificates.  See Section 8 for information about the certificate extension.</p>
<h2 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#certificate-extension-scope-and-structure" id="certificate-extension-scope-and-structure">Certificate Extension Scope and Structure</a></h2>
<p id="rfc.section.5.2.p.1">This specification places no limits on the number of telephone numbers that can be associated with any given certificate.  Some service providers may be assigned millions of numbers, and may wish to have a single certificate that can be applied to signing for any one of those numbers.  Others may wish to compartmentalize authority over subsets of the numbers they control.</p>
<p id="rfc.section.5.2.p.2">Moreover, service providers may wish to have multiple certificates with the same scope of authority.  For example, a service provider with several regional gateway systems may want each system to be capable of signing for each of their numbers, but not want to have each system share the same private key.</p>
<p id="rfc.section.5.2.p.3">The set of telephone numbers for which a particular certificate is valid is expressed in the certificate through a certificate extension; the certificate&#8217;s extensibility mechanism is defined in <a href="#RFC5280">[RFC5280]</a> but the TN Authorization List extension is specified in this document.</p>
<p id="rfc.section.5.2.p.4">The subjects of certificates containing the TN Authorization List extension are typically the administrative entities to whom numbers are assigned or delegated.  For example, a LEC might hold a certificate for a range of telephone numbers.  In some cases, the organization or individual issued such a certificate may not want to associate themselves with a certificate; for example, a private individual with a certificate for a single telephone number might not want to distribute that certificate publicly if every verifier immediately knew their name.  The certification authorities issuing certificates with the TN Authorization List extensions may, in accordance with their policies, obscure the identity of the subject, though mechanisms for doing so are outside the scope of this document.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#provisioning-private-keying-material" id="provisioning-private-keying-material">Provisioning Private Keying Material</a></h1>
<p id="rfc.section.6.p.1">In order for authentication services to sign calls via the procedures described in <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a>, they must hold a private key corresponding to a certificate with authority over the calling number.  <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> does not require that any particular entity in a SIP deployment architecture sign requests, only that it be an entity with an appropriate private key; the authentication service role may be instantiated by any entity in a SIP network.  For a certificate granting authority only over a particular number which has been issued to an end user, for example, an end user device might hold the private key and generate the signature.  In the case of a service provider with authority over large blocks of numbers, an intermediary might hold the private key and sign calls.</p>
<p id="rfc.section.6.p.2">The specification RECOMMENDS distribution of private keys through PKCS#8 objects signed by a trusted entity, for example through the CMS package specified in <a href="#RFC5958">[RFC5958]</a>.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#cert-acquire" id="cert-acquire">Acquiring Credentials to Verify Signatures</a></h1>
<p id="rfc.section.7.p.1">This specification documents multiple ways that a verifier can gain access to the credentials needed to verify a request.  As the validity of certificates does not depend on the method of their acquisition, there is no need to standardize any single mechanism for this purpose.  All entities that comply with <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> necessarily support SIP, and consequently SIP itself can serve as a way to deliver certificates.  <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> provides an &#8220;info&#8221; parameter of the Identity header which contains a URI for the credential used to generate the Identity header; <a href="#I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</a> also requires documents which define credential systems list the URI schemes that may be present in the &#8220;info&#8221; parameter.  For implementations compliant with this specification, three URI schemes are REQUIRED: the CID URI, the SIP URI, and the HTTP URI.</p>
<p id="rfc.section.7.p.2">The simplest way for a verifier to acquire the certificate needed to verify a signature is for the certificate be conveyed in a SIP request along with the signature itself.  In SIP, for example, a certificate could be carried in a multipart MIME body <a href="#RFC2046">[RFC2046]</a>, and the URI in the Identity header &#8220;info&#8221; parameter could specify that body with a CID URI <a href="#RFC2392">[RFC2392]</a>.  However, in many environments this is not feasible due to message size restrictions or lack of necessary support for multipart MIME.</p>
<p id="rfc.section.7.p.3">The Identity header &#8220;info&#8221; parameter in a SIP request may contain a URI that the verifier dereferences.  Implementations of this specification are REQUIRED to support the use of SIP for this function (via the SUBSCRIBE/NOTIFY mechanism) as well as HTTP and HTTPS.</p>
<p id="rfc.section.7.p.4">Note well that as an optimization, a verifier may have access to a service, a cache or other local store that grants access to certificates for a particular telephone number.  However, there may be multiple valid certificates that can sign a call setup request for a telephone number, and as a consequence, there needs to be some discriminator that the signer uses to identify their credentials.  The Identity header &#8220;info&#8221; parameter itself can serve as such a discriminator, provided implementations use that parameter as a key when accessing certificates from caches or other sources.</p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#jwt-claim-constraints-syntax" id="jwt-claim-constraints-syntax">JWT Claim Constraints Syntax</a></h1>
<p id="rfc.section.8.p.1">The subjects of certificates containing the JWT Claim Constraints certificate extension are specifies values for PASSporT claims that are permitted.  The syntax of these claims is given in PASSporT; specifying new claims follows the procedures in <a href="#I-D.ietf-stir-passport">[I-D.ietf-stir-passport]</a> (Section 8.3).  When a verifier is validating PASSporT claims, the JWT claim MUST contain permitted values.  The non-critical JWT Claim Constraints certificate extension is included in the extension field of end entity certificates <a href="#RFC5280">[RFC5280]</a>.  The extension is defined with ASN.1 <a href="#X.680">[X.680]</a><a href="#X.681">[X.681]</a> <a href="#X.682">[X.682]</a><a href="#X.683">[X.683]</a>.</p>
<p id="rfc.section.8.p.2">The JWT Claim Constraints certificate extension places constraints on the values that are allowed in particular JWT claims.  This certificate extension is optional, but if present, it constrains the claims that authentication services may included in the PASSporT objects they sign.  For example, imagine a PASSporT extension claim called &#8220;confidence&#8221; with values &#8220;low&#8221;, &#8220;medium&#8221;, and &#8220;high&#8221;.  If a CA issues to an authentication service a certificate that contains the value &#8220;confidence&#8221; in the &#8220;claim&#8221; field and &#8220;high&#8221; in the &#8220;permitted&#8221; feild of the JWT Claim Constraints, then an authentication service MAY add a &#8220;high&#8221; &#8220;confidence&#8221; claim to any PASSporTs it generates.  A verification service MUST treat as invalid any PASSporT it receives with a PASSporT extension claim that is not included in JWT Claim Constraints.  The baseline claims of PASSporT (&#8220;orig&#8221;, &#8220;dest&#8221;, &#8220;iat&#8221; and &#8220;mky&#8221;) are considered to be permitted by default and SHOULD NOT be included in the &#8220;claim&#8221; field.  The issuer of a certificate may similarly explicitly allow the use of a particular claim by the holder of the certificate.  If a certificate contains no JWT Claim Constraints, the issuer of the certificate permits all claims.</p>
<p id="rfc.section.8.p.3">The JWT Claim Constraints certificate extension is identified by the following object identifier (OID), which is defined under the id-pe OID arc defined in <a href="#RFC5280">[RFC5280]</a> and managed by IANA (see <a href="#iana">Section 11</a>):</p>
<pre>
  id-pe-JWTClaimConstraints OBJECT IDENTIFIER ::= { id-pe 25 }
</pre>
<p id="rfc.section.8.p.4">The JWT Claim Constraints certificate extension has the following syntax:</p>
<pre>
  JWTClaimConstraints ::= SEQUENCE SIZE (1..MAX) OF JWTClaimConstraint

  JWTClaimConstraint ::= SEQUENCE {
    claim     IA5String,
    permitted SEQUENCE OF IA5String
    }
</pre>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#tn-authz-list" id="tn-authz-list">TN Authorization List Syntax</a></h1>
<p id="rfc.section.9.p.1">The subjects of certificates containing the TN Authorization List extension are the administrative entities to whom numbers are assigned or delegated.  When a verifier is validating a caller&#8217;s identity, local policy always determines the circumstances under which any particular subject may be trusted, but the purpose of the TN Authorization List extension in particular is to allow a verifier to ascertain when the CA has designated that the subject has authority over a particular telephone number or number range.  The non critical Telephony Number (TN) Authorization List certificate extension is included in the Certificate&#8217;s extension field <a href="#RFC5280">[RFC5280]</a>.  The extension is defined with ASN.1 <a href="#X.680">[X.680]</a><a href="#X.681">[X.681]</a><a href="#X.682">[X.682]</a> <a href="#X.683">[X.683]</a>.  What follows is the syntax and semantics of the extension.</p>
<p id="rfc.section.9.p.2">The subjects of certificates containing the TN Authorization List extension are the administrative entities to whom numbers are assigned or delegated.  In an end entity certificate, TN Authorization List indicates the TNs which the certificate has been authorized.  In a CA certificate, the TN Authorization List limits the set of TNs for certification paths that include this certificate.</p>
<p id="rfc.section.9.p.3">The Telephony Number (TN) Authorization List certificate extension is identified by the following object identifier (OID), which is defined under the id-pe OID arc defined in <a href="#RFC5280">[RFC5280]</a> and managed by IANA (see <a href="#iana">Section 11</a>):</p>
<pre>
  id-pe-TNAuthList OBJECT IDENTIFIER ::= { id-pe 26 }
</pre>
<p id="rfc.section.9.p.4">The TN Authorization List certificate extension has the following syntax:</p>
<pre>
  TNAuthorizationList ::= SEQUENCE SIZE (1..MAX) OF TNEntry

  TNEntry ::= CHOICE {
    spc   [0] ServiceProviderCodeList,
    range [1] TelephoneNumberRange,
    one       E164Number
    }

  ServiceProviderCodeList ::= SEQUENCE SIZE (1..3) OF IA5String

  -- Service Provider Codes may be OCNs, various SPIDs, or other
  -- SP identifiers from the telephone network

  TelephoneNumberRange ::= SEQUENCE {
    start E164Number,
    count INTEGER
    }

  E164Number ::= IA5String (SIZE (1..15)) (FROM ("0123456789#*"))
</pre>
<p id="rfc.section.9.p.5">The TN Authorization List certificate extension indicates the authorized phone numbers for the call setup signer.  It indicates one or more blocks of telephone number entries that have been authorized for use by the call setup signer.  There are three ways to identify the block:</p>
<p/>

<ol>
  <li>Service Provider Codes as described in this document are a generic term for the identifiers used to designate service providers in the telepohone networks today.  In North American context, these would include Operating Company Numbers (OCNs) as specified in <a href="#ATIS-0300251">[ATIS-0300251]</a>, related Service Provide Identifiers (SPIDs), or other similar identifiers for service providers.  SPCs can be used to indirectly name all of the telephone numbers associated with that identifier for a service provider,</li>
  <li>Telephone numbers can be listed in a range (in the TelephoneNumberRange format), which consists of a starting telephone number and then an integer count of numbers within the range, where the valid boundaries of ranges may vary according to national policies, or</li>
  <li>A single telephone number can be listed (as an E164Number).</li>
</ol>
<p id="rfc.section.9.p.7">Note that because large-scale service providers may want to associate many numbers, possibly millions of numbers, with a particular certificate, optimizations are required for those cases to prevent certificate size from becoming unmanageable.  In these cases, the TN Authorization List may be given by reference rather than by value, through the presence of a separate certificate extension that permits verifiers to either securely download the list of numbers associated with a certificate, or to verify that a single number is under the authority of this certificate.  For more on this optimization, see <a href="#acquire">Section 10.1</a>.</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#cert-fresh" id="cert-fresh">Certificate Freshness and Revocation</a></h1>
<p id="rfc.section.10.p.1">Regardless of which of the approaches in Section 3 is followed for using certificates, a certificate verification mechanism is required.  However, the traditional problem of certificate freshness gains a new wrinkle when using the TN Authorization List extension with telephone numbers or number ranges (as opposed to SPCs), because verifiers must establish not only that a certificate remains valid, but also that the certificate&#8217;s scope contains the telephone number that the verifier is validating.  Dynamic changes to number assignments can occur due to number portability, for example.  So even if a verifier has a valid cached certificate for a telephone number (or a range containing the number), the verifier must determine that the entity that signed is still a proper authority for that number.</p>
<p id="rfc.section.10.p.2">To verify the status of such a certificate, the verifier needs to acquire the certificate if necessary (via the methods described in Section 7), and then would need to either:</p>
<p id="rfc.section.10.p.3">a.  Rely on short-lived certificates and not check the certificate&#8217;s status, or</p>
<p id="rfc.section.10.p.4">b.  Rely on status information from the authority (e.g., OCSP)</p>
<p id="rfc.section.10.p.5">The tradeoff between short lived certificates and using status information is that the former&#8217;s burden is on the front end (i.e., enrollment) and the latter&#8217;s burden is on the back end (i.e., verification).  Both impact call setup time, but some approaches to generating a short-lived certificate, like requiring one for each call, would incur a greater operational cost than acquiring status information.  This document makes no particular recommndation for a means of determinate certificate freshness for STIR, as this requires further study and implementation experience.  Acquiring online status information for certificates has the potential to disclose private information <a href="#RFC7258">[RFC7258]</a> if proper precautions are not taken.  Future specifications that define certificate freshness mechanisms for STIR MUST note any such risks and provide countermeasures where possible.</p>
<h2 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> <a href="#acquire" id="acquire">Acquiring TN Lists By Reference</a></h2>
<p id="rfc.section.10.1.p.1">One alternative to checking certificate status for a particular telephone number is simply acquiring the TN Authorization List by reference, that is, through dereferencing a URL in the certificate, rather than including the value of the TN Authorization List in the certificate itself.</p>
<p id="rfc.section.10.1.p.2">Acquiring a list of the telephone numbers associated with a certificate or its subject lends itself to an application-layer query/response interaction outside of certificate status, one which could be initiated through a separate URI included in the certificate.  The AIA extension (see <a href="#RFC5280">[RFC5280]</a>) supports such a mechanism: it designates an OID to identify the accessMethod and an accessLocation, which would most likely be a URI.  A verifier would then follow the URI to ascertain whether the list of TNs are authorized for use by the caller.</p>
<p id="rfc.section.10.1.p.3">HTTPS is the most obvious candidate for a protocol to be used for fetching the list of telephone numbers associated with a particular certificate.  This document defines a new AIA accessMethod, called &#8220;id-ad-stirTNList&#8221;, which uses the following AIA OID:</p>
<pre>
  id-ad-stirTNList  OBJECT IDENTIFIER ::= { id-ad 14 }
</pre>
<p id="rfc.section.10.1.p.4">When the &#8220;id-ad-stirTNList&#8221; accessMethod is used, the accessLocation MUST be an HTTPS URI.  The document returned by dereferencing that URI will contain the complete TN Authorization List (see <a href="#tn-authz-list">Section 9</a>) for the certificate.</p>
<p id="rfc.section.10.1.p.5">Delivering the entire list of telephone numbers associated with a particular certificate will divulge to STIR verifiers information about telephone numbers other than the one associated with the particular call that the verifier is checking.  In some environments, where STIR verifiers handle a high volume of calls, maintaining an up-to-date and complete cache for the numbers associated with crucial certificate holders could give an important boost to performance.</p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<p id="rfc.section.11.p.1">This document makes use of object identifiers for the TN Certificate Extension defined in Section 9, the TN by reference AIA access descriptor defined in Section 10.1, and the ASN.1 module identifier defined in Appendix A.  It therefore requests that the IANA make the following assignments:</p>
<p/>

<ul>
  <li>JWT Claim Constraints Certificate Extension in the SMI Security for PKIX Certificate Extension registry:</li>
</ul>
<pre>
    http://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml#smi-
    numbers-1.3.6.1.5.5.7.1
</pre>
<p/>

<ul>
  <li>TN Certificate Extension in the SMI Security for PKIX Certificate Extension registry: http://www.iana.org/assignments/smi-numbers/ smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.1</li>
  <li>TNS by reference access descriptor in the SMI Security for PKIX Access Descriptor registry: http://www.iana.org/assignments/smi- numbers/smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.48</li>
  <li>The TN ASN.1 module in SMI Security for PKIX Module Identifier registry: http://www.iana.org/assignments/smi-numbers/smi- numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.0</li>
</ul>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.12.p.1">This document is entirely about security.  For further information on certificate security and practices, see <a href="#RFC5280">[RFC5280]</a>, in particular its Security Considerations.</p>
<h1 id="rfc.section.13"><a href="#rfc.section.13">13.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.13.p.1">Anders Kristensen, Russ Housley, Brian Rosen, Cullen Jennings, Dave Crocker, Tony Rutkowski, John Braunberger, and Eric Rescorla provided key input to the discussions leading to this document.  Russ Housley provided some direct assistance and text surrounding the ASN.1 module.</p>
<h1 id="rfc.references"><a href="#rfc.references">14.</a> References</h1>
<h2 id="rfc.references.1"><a href="#rfc.references.1">14.1.</a> Normative References</h2>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="ATIS-0300251">[ATIS-0300251]</b>
      </td>
      <td class="top"><a>ATIS Recommendation 0300251</a>, "<a>Codes for Identification of Service Providers for Information Exchange</a>", 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="DSS">[DSS]</b>
      </td>
      <td class="top"><a>National Institute of Standards and Technology, U.S. Department of Commerce</a>, "<a>Digital Signature Standard, version 4</a>", NIST FIPS PUB 186-4, 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-stir-passport">[I-D.ietf-stir-passport]</b>
      </td>
      <td class="top"><a>Wendt, C.</a> and <a>J. Peterson</a>, "<a href="http://tools.ietf.org/html/draft-ietf-stir-passport-11">Personal Assertion Token (PASSporT)</a>", Internet-Draft draft-ietf-stir-passport-11, February 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-stir-rfc4474bis">[I-D.ietf-stir-rfc4474bis]</b>
      </td>
      <td class="top"><a>Peterson, J.</a>, <a>Jennings, C.</a>, <a>Rescorla, E.</a> and <a>C. Wendt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-stir-rfc4474bis-16">Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>", Internet-Draft draft-ietf-stir-rfc4474bis-16, February 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2392">[RFC2392]</b>
      </td>
      <td class="top"><a>Levinson, E.</a>, "<a href="http://tools.ietf.org/html/rfc2392">Content-ID and Message-ID Uniform Resource Locators</a>", RFC 2392, DOI 10.17487/RFC2392, August 1998.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3447">[RFC3447]</b>
      </td>
      <td class="top"><a>Jonsson, J.</a> and <a>B. Kaliski</a>, "<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>", RFC 3447, DOI 10.17487/RFC3447, February 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3986">[RFC3986]</b>
      </td>
      <td class="top"><a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5280">[RFC5280]</b>
      </td>
      <td class="top"><a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5912">[RFC5912]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a> and <a>J. Schaad</a>, "<a href="http://tools.ietf.org/html/rfc5912">New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)</a>", RFC 5912, DOI 10.17487/RFC5912, June 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5958">[RFC5958]</b>
      </td>
      <td class="top"><a>Turner, S.</a>, "<a href="http://tools.ietf.org/html/rfc5958">Asymmetric Key Packages</a>", RFC 5958, DOI 10.17487/RFC5958, August 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7230">[RFC7230]</b>
      </td>
      <td class="top"><a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="http://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7258">[RFC7258]</b>
      </td>
      <td class="top"><a>Farrell, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc7258">Pervasive Monitoring Is an Attack</a>", BCP 188, RFC 7258, DOI 10.17487/RFC7258, May 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7519">[RFC7519]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7519">JSON Web Token (JWT)</a>", RFC 7519, DOI 10.17487/RFC7519, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.509">[X.509]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.509 | ISO/IEC 9594-8</a>, "<a>Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks</a>", 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.680">[X.680]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.680 | ISO/IEC 8824-1</a>, "<a>Information Technology - Abstract Syntax Notation One: Specification of basic notation</a>", 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.681">[X.681]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.681 | ISO/IEC 8824-2</a>, "<a>Information Technology - Abstract Syntax Notation One: Information Object Specification</a>", 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.682">[X.682]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.682 | ISO/IEC 8824-2</a>, "<a>Information Technology - Abstract Syntax Notation One: Constraint Specification</a>", 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.683">[X.683]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.683 | ISO/IEC 8824-3</a>, "<a>Information Technology - Abstract Syntax Notation One: Parameterization of ASN.1 Specifications</a>", 2015.</td>
    </tr>
  </tbody>
</table>
<h2 id="rfc.references.2"><a href="#rfc.references.2">14.2.</a> Informative References</h2>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2046">[RFC2046]</b>
      </td>
      <td class="top"><a>Freed, N.</a> and <a>N. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>", RFC 2046, DOI 10.17487/RFC2046, November 1996.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3647">[RFC3647]</b>
      </td>
      <td class="top"><a>Chokhani, S.</a>, <a>Ford, W.</a>, <a>Sabett, R.</a>, <a>Merrill, C.</a> and <a>S. Wu</a>, "<a href="http://tools.ietf.org/html/rfc3647">Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework</a>", RFC 3647, DOI 10.17487/RFC3647, November 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7340">[RFC7340]</b>
      </td>
      <td class="top"><a>Peterson, J.</a>, <a>Schulzrinne, H.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc7340">Secure Telephone Identity Problem Statement and Requirements</a>", RFC 7340, DOI 10.17487/RFC7340, September 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7375">[RFC7375]</b>
      </td>
      <td class="top"><a>Peterson, J.</a>, "<a href="http://tools.ietf.org/html/rfc7375">Secure Telephone Identity Threat Model</a>", RFC 7375, DOI 10.17487/RFC7375, October 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X.520">[X.520]</b>
      </td>
      <td class="top"><a>ITU-T Recommendation X.520 | ISO/IEC 9594-6</a>, "<a>Information technology - Open Systems Interconnection - The Directory: Selected Attribute Types</a>", 2012.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#asn1-module" id="asn1-module">ASN.1 Module</a></h1>
<p id="rfc.section.A.p.1">This appendix provides the normative ASN.1 <a href="#X.680">[X.680]</a> definitions for the structures described in this specification using ASN.1, as defined in <a href="#X.680">[X.680]</a> through <a href="#X.683">[X.683]</a>.</p>
<p id="rfc.section.A.p.2">The modules defined in this document are compatible with the most current ASN.1 specification published in 2015 (see <a href="#X.680">[X.680]</a>, <a href="#X.681">[X.681]</a>, <a href="#X.682">[X.682]</a>, <a href="#X.683">[X.683]</a>).  None of the newly defined tokens in the 2008 ASN.1 (DATE, DATE-TIME, DURATION, NOT-A-NUMBER, OID-IRI, RELATIVE- OID-IRI, TIME, TIME-OF-DAY)) are currently used in any of the ASN.1 specifications referred to here.</p>
<p id="rfc.section.A.p.3">This ASN.1 module imports ASN.1 from <a href="#RFC5912">[RFC5912]</a>.</p>
<pre>
  TN-Module-2016
    { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-tn-module(88) }

  DEFINITIONS EXPLICIT TAGS ::= BEGIN

  IMPORTS

  id-ad, id-pe
  FROM PKIX1Explicit-2009  -- From [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51) }

  EXTENSION
  FROM PKIX-CommonTypes-2009  -- From [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57) }

  ;

  --
  -- JWT Claim Constraints Certificate Extension
  --

  ext-jwtClaimConstraints EXTENSION  ::= {
    SYNTAX JWTClaimConstraints IDENTIFIED BY id-pe-JWTClaimConstraints
    } 

  id-pe-JWTClaimConstraints OBJECT IDENTIFIER ::= { id-pe 25 }

  JWTClaimConstraints ::= SEQUENCE SIZE (1..MAX) OF JWTClaimConstraint

  JWTClaimConstraint ::= SEQUENCE {
    claim     IA5String,
    permitted SEQUENCE OF IA5String
    }

  --
  -- Telephone Number Authorization List Certificate Extension
  --

  ext-tnAuthList  EXTENSION  ::= {
    SYNTAX TNAuthorizationList IDENTIFIED BY id-pe-TNAuthList
    }

  id-pe-TNAuthList OBJECT IDENTIFIER ::= { id-pe 26 }

  TNAuthorizationList ::= SEQUENCE SIZE (1..MAX) OF TNEntry

  TNEntry ::= CHOICE {
    spc    [0] ServiceProviderCodeList,
    range  [1] TelephoneNumberRange,
    one        E164Number
    }

  ServiceProviderCodeList ::= SEQUENCE SIZE (1..3) OF IA5String

  -- Service Provider Codes may be OCNs, various SPIDs, or other
  -- SP identifiers from the telephone network

  TelephoneNumberRange ::= SEQUENCE {
    start E164Number,
    count INTEGER
    }

  E164Number ::= IA5String (SIZE (1..15)) (FROM ("0123456789"))

  -- TN Access Descriptor

  id-ad-stirTNList OBJECT IDENTIFIER ::= { id-ad 14 }

  END
</pre>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jon Peterson</span> 
	  <span class="n hidden">
		<span class="family-name">Peterson</span>
	  </span>
	</span>
	<span class="org vcardline">Neustar, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jon.peterson@neustar.biz">jon.peterson@neustar.biz</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sean Turner</span> 
	  <span class="n hidden">
		<span class="family-name">Turner</span>
	  </span>
	</span>
	<span class="org vcardline">sn3rd</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sean@sn3rd.com">sean@sn3rd.com</a></span>

  </address>
</div>

</body>
</html>
